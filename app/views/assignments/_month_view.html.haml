= javascript_include_tag "calendar"
= javascript_include_tag "month/popups_and_dialogs"
= javascript_include_tag "month/delete_assignment"
= javascript_include_tag "month/add_assignment"
= javascript_include_tag "month/edit_assignment"

.choose_view
  .nav_view
    = link_to "Week", assignments_path(:query => 'week', :which => params[:which].to_date.beginning_of_week) 
    = link_to "Month", assignments_path(:query => 'month', :which => params[:which]), 
    {:class => "current"}

  .rotate_through
    = link_to "Prev",assignments_path(:query => 'month', :which => params[:which].to_date.prev_month.beginning_of_month),
      {:class => "which_btn"}
    - @other_class = params[:which].to_date.beginning_of_month == Date.today.beginning_of_month ? "current" : nil
    = link_to "This month", assignments_path(:query => 'month', :which => Date.today.beginning_of_month), 
      {:class => "#{@other_class} which_btn"}
    = link_to "Next", assignments_path(:query => 'month', :which => params[:which].to_date.next_month.beginning_of_month), 
      {:class => "which_btn"}
%h2
  = params[:which].to_date.strftime("%B, %Y")

#cal_wrapper
  .cal
    .cal_header
         
    - @list_each_week= []
    - @list_each_week << @days_in_cal_month[0..6]
    - @list_each_week << @days_in_cal_month[7..13]
    - @list_each_week << @days_in_cal_month[14..20]
    - @list_each_week << @days_in_cal_month[21..27]
    - @list_each_week << @days_in_cal_month[28..34]
    %table
      %tr
        %th Sun.
        %th Mon.
        %th Tues.
        %th Wed.
        %th Thurs.
        %th Fri.
        %th Sat.
      %tr
      - @list_each_week.each do |week|
        /- binding.pry
        %tr 
          -week.each do |date|
            %td{:'data-date' => date}
              .add_dialog{:'data-date' => date}


              - todayHuh = (Date.today.to_date === date)
              .cal_day{:id => (todayHuh ? "cal_day_today" : nil) }
                = date.strftime("%d")
                - if todayHuh
                  %span Today
              .day_cal
                - if @as_grouped_by_dd[date]
                  - @as_grouped_by_dd[date].each do |a|
                    .assignment_link{:class => (a.completed ? "completed" : "not_completed"), 
                    :'data-assignment-id' => a.id, :'data-due-time' => a.due_date.strftime("%H:%M"), 
                    :'data-subject' => a.subject.name, :'data-description' => a.description, 
                    :'data-subject-id' => a.subject.id}
                      = a.subject.name

#edit_dialog
  %form
    %label * Subject
    %select.select_subject
      %option
      - @subjects.each do |s|
        %option{value:"#{s.id}"}
          = s.name
    %label * Description
    %input{type:'text', maxlength: 255, size:50, name:'description'}
    %label * Due date
    %input{type: 'text', class: 'datepicker'}
    %input{type: 'text', class: 'timepicker'}
    %label Completed?
    %input{type: 'radio', name:'completed', value:'yes'} Yes
    %input{type: 'radio', name:'completed', value:'no', checked:'checked'} No
    %input{type:'submit', value:'submit', class:'edit_dialog_submit'}

.delete_dialog
  Are you sure you want to delete this assignment? 
  %button
#add_dialog
  %form
    %label * Subject
    %select.select_subject
      %option
      - @subjects.each do |s|
        %option{value:"#{s.id}"}
          = s.name
    %label * Description
    %input{type:'text', maxlength: 255, size: 50, name:'description'}
    %label * Due date
    %input{type: 'text', class: 'datepicker'}
    %input{type: 'text', class: 'timepicker'}
    %label Completed?
    %input{type: 'radio', name:'completed', value:'yes'} Yes
    %input{type: 'radio', name:'completed', value:'no', checked:'checked'} No
    %input{type:'submit', value:'submit', class:'add_dialog_submit'}
.a_popup
  .a_box_month
    .subject
    .description
    .due_time
      .break
.a_dialog
  .a_box_month
    .subject
    .description
    .due_time
    .delete_btn
    .edit_btn

